<!DOCTYPE html>
<html>
<head>
  <title>Firebase User Image Upload & Retrieve (Base64 Method)</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>
<body>
  <h2>Upload User Image</h2>
  <input type="file" id="fileInput" />
  <button onclick="uploadImage()">Upload</button>

  <h2>Retrieve User Image</h2>
  <input type="text" id="userId" placeholder="Enter User ID" />
  <button onclick="getImage()">Get Image</button>
  <br><br>
  <img id="userImage" width="200" style="display:none;" />

  <script>
    // Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyBDKROSvSzPwXfostKb0lpzMSonRz_CCs",
      authDomain: "exam-71dac.firebaseapp.com",
      databaseURL: "https://exam-71dac-default-rtdb.firebaseio.com",
      projectId: "exam-71dac",
      storageBucket: "exam-71dac.appspot.com",
      messagingSenderId: "277973453768",
      appId: "1:277973453768:web:deb8493289262a324ea43fd",
      measurementId: "G-8TYS2GFJED"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // Upload Image (as Base64 string into DB)
    function uploadImage() {
      const file = document.getElementById("fileInput").files[0];
      if (!file) {
        alert("Please select an image first!");
        return;
      }

      const reader = new FileReader();
      reader.onloadend = function() {
        const base64Image = reader.result; // image in Base64 format
        const userId = "user1"; // you can make dynamic

        // Save to database
        database.ref("users/" + userId).set({
          profileImage: base64Image
        });

        alert("Image uploaded successfully!");
      };
      reader.readAsDataURL(file); // Convert to Base64
    }

    // Retrieve Image
    function getImage() {
      const userId = document.getElementById("userId").value;
      if (!userId) {
        alert("Enter User ID!");
        return;
      }

      database.ref("users/" + userId + "/profileImage").once("value")
        .then(snapshot => {
          const data = snapshot.val();
          if (data) {
            const img = document.getElementById("userImage");
            img.src = data; // Base64 image string
            img.style.display = "block";
          } else {
            alert("No image found for this user!");
          }
        });
    }
  </script>
</body>
</html>
